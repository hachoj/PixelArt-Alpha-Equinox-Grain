[2025-12-17 10:52:44,507][jax._src.xla_bridge][INFO] - Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
[2025-12-17 10:52:45,398][absl][INFO] - [thread=MainThread] Failed to get flag value for EXPERIMENTAL_ORBAX_USE_DISTRIBUTED_PROCESS_ID.
[2025-12-17 10:52:45,399][absl][INFO] - [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=('state', 'model_ema', 'dataset'), item_handlers=None, handler_registry=None
[2025-12-17 10:52:45,400][absl][INFO] - Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x14cc0f9ef190>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`.
[2025-12-17 10:52:45,400][absl][INFO] - Initialized registry DefaultCheckpointHandlerRegistry({('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x14cc0f9ef190>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x14cc0f9ef190>}).
[2025-12-17 10:52:45,400][absl][INFO] - orbax-checkpoint version: 0.11.30
[2025-12-17 10:52:45,400][absl][INFO] - [process=0][thread=MainThread] Using barrier_sync_fn: <function get_barrier_sync_fn.<locals>.<lambda> at 0x14cc0f986b60> timeout: 600 secs and primary_host=0 for async checkpoint writes
[2025-12-17 10:52:45,405][absl][INFO] - Read Metadata={'item_handlers': {'dataset': 'grain._src.python.checkpoint_handlers.CheckpointHandler', 'model_ema': 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler', 'state': 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1765522753642318214, 'commit_timestamp_nsecs': 1765522772961995583, 'custom_metadata': {}} from /blue/weishao/chojnowski.h/JaxFM/checkpoints/300000/_CHECKPOINT_METADATA
[2025-12-17 10:52:45,406][absl][INFO] - Missing metrics for step 300000
[2025-12-17 10:52:45,406][absl][INFO] - Found 1 checkpoint steps in /blue/weishao/chojnowski.h/JaxFM/checkpoints
[2025-12-17 10:52:45,406][absl][INFO] - [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=5, keep_time_interval=None, keep_period=None, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=True, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, todelete_full_path=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=True, async_options=None, multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None, preservation_policy=None, prevent_write_metrics=False, enable_should_save_is_saving_in_progress_check=True, enable_per_process_directory_creation=False), root_directory=/blue/weishao/chojnowski.h/JaxFM/checkpoints: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x14cc0fa6a750>
[2025-12-17 10:52:45,406][absl][INFO] - [process=0][thread=MainThread] CheckpointManager init: checkpointers=None, item_names=('model',), item_handlers=None, handler_registry=None
[2025-12-17 10:52:45,406][absl][INFO] - Deferred registration for item: "metrics". Adding handler `<orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x14cc0f9aded0>` for item "metrics" and save args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>` to `_handler_registry`.
[2025-12-17 10:52:45,406][absl][INFO] - Initialized registry DefaultCheckpointHandlerRegistry({('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonSaveArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x14cc0f9aded0>, ('metrics', <class 'orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonRestoreArgs'>): <orbax.checkpoint._src.handlers.json_checkpoint_handler.JsonCheckpointHandler object at 0x14cc0f9aded0>}).
[2025-12-17 10:52:45,408][absl][INFO] - Found 0 checkpoint steps in /blue/weishao/chojnowski.h/JaxFM/new_model
[2025-12-17 10:52:45,408][absl][INFO] - [process=0][thread=MainThread] CheckpointManager created,  primary_host=0, CheckpointManagerOptions=CheckpointManagerOptions(save_interval_steps=1, max_to_keep=1, keep_time_interval=None, keep_period=None, should_keep_fn=None, best_fn=None, best_mode='max', keep_checkpoints_without_metrics=True, step_prefix=None, step_format_fixed_length=None, step_name_format=None, create=True, cleanup_tmp_directories=False, save_on_steps=frozenset(), single_host_load_and_broadcast=False, todelete_subdir=None, todelete_full_path=None, enable_background_delete=False, read_only=False, enable_async_checkpointing=False, async_options=None, multiprocessing_options=MultiprocessingOptions(primary_host=0, active_processes=None, barrier_sync_key_prefix=None), should_save_fn=None, file_options=FileOptions(path_permission_mode=None), save_root_metadata=True, temporary_path_class=None, save_decision_policy=None, preservation_policy=None, prevent_write_metrics=False, enable_should_save_is_saving_in_progress_check=True, enable_per_process_directory_creation=False), root_directory=/blue/weishao/chojnowski.h/JaxFM/new_model: <orbax.checkpoint.checkpoint_manager.CheckpointManager object at 0x14cc0fa2aa10>
Restoring previous trianing at step 300000/300000
[2025-12-17 10:52:50,052][absl][INFO] - Restoring checkpoint from /blue/weishao/chojnowski.h/JaxFM/checkpoints/300000.
[2025-12-17 10:52:50,054][absl][INFO] - No entry found in handler registry for item: state and args with type: <class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardRestoreArgs'>. Falling back to global handler registry.
[2025-12-17 10:52:50,054][absl][INFO] - save_device_host_concurrent_bytes=None
[2025-12-17 10:52:50,054][absl][INFO] - Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x14cc10ca2150>, enable_pinned_host_transfer=True, save_concurrent_bytes: 96000000000 (89.4 GiB), restore_concurrent_bytes: 96000000000 (89.4 GiB)
[2025-12-17 10:52:50,054][absl][INFO] - Deferred registration for item: "state". Adding handler `<orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler object at 0x14cc0fb67010>` for item "state" and save args `<class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardRestoreArgs'>` to `_handler_registry`.
[2025-12-17 10:52:53,908][absl][INFO] - [process=0] /jax/checkpoint/read/gbytes_per_sec: 2.010 GiB/s (total gbytes: 7.6 GiB) (time elapsed: 3 seconds) (per-host)
[2025-12-17 10:52:53,911][absl][INFO] - Finished restoring checkpoint in 3.86 seconds from /blue/weishao/chojnowski.h/JaxFM/checkpoints/300000.
[2025-12-17 10:52:53,911][absl][INFO] - {'step': 300000, 'event_type': 'restore', 'directory': '/blue/weishao/chojnowski.h/JaxFM/checkpoints', 'checkpointer_start_time': 1765986770.0511196, 'checkpointer_duration_secs': 3.860145092010498, 'checkpoint_manager_start_time': 1765986770.050982, 'checkpoint_manager_duration_secs': 3.860283851623535}
[2025-12-17 10:52:55,450][absl][INFO] - [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
[2025-12-17 10:52:55,450][absl][INFO] - [process=0] Saving checkpoint at step 0
[2025-12-17 10:52:55,450][absl][INFO] - [process=0] Started saving checkpoint to /blue/weishao/chojnowski.h/JaxFM/new_model/0.
[2025-12-17 10:52:55,451][absl][WARNING] - Attempted to create temporary directory /blue/weishao/chojnowski.h/JaxFM/new_model/0.orbax-checkpoint-tmp which already exists. Removing existing directory since it is not finalized.
[2025-12-17 10:52:55,452][absl][INFO] - Creating tmp directory /blue/weishao/chojnowski.h/JaxFM/new_model/0.orbax-checkpoint-tmp
[2025-12-17 10:52:55,461][absl][INFO] - Wrote Metadata={'item_handlers': None, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1765986775461170262, 'commit_timestamp_nsecs': None, 'custom_metadata': {}}, json={"item_handlers": null, "metrics": {}, "performance_metrics": {}, "init_timestamp_nsecs": 1765986775461170262, "commit_timestamp_nsecs": null, "custom_metadata": {}} to /blue/weishao/chojnowski.h/JaxFM/new_model/0.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
[2025-12-17 10:52:55,462][absl][INFO] - Using ThreadSafeKeyValueSignalingClient
[2025-12-17 10:52:55,462][absl][WARNING] - [process=0][thread=MainThread][operation_id=1] _SignalingThread.join() waiting for signals ([]) blocking the main thread will slow down blocking save times. This is likely due to main thread calling result() on a CommitFuture.
[2025-12-17 10:52:55,464][absl][INFO] - Creating tmp directory /blue/weishao/chojnowski.h/JaxFM/new_model/0.orbax-checkpoint-tmp/model.orbax-checkpoint-tmp
[2025-12-17 10:52:55,468][absl][INFO] - No entry found in handler registry for item: model and args with type: <class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardSaveArgs'>. Falling back to global handler registry.
[2025-12-17 10:52:55,468][absl][INFO] - save_device_host_concurrent_bytes=None
[2025-12-17 10:52:55,468][absl][INFO] - Created BasePyTreeCheckpointHandler: use_ocdbt=True, use_zarr3=False, pytree_metadata_options=PyTreeMetadataOptions(support_rich_types=False), array_metadata_store=<orbax.checkpoint._src.metadata.array_metadata_store.Store object at 0x14cc10ca2150>, enable_pinned_host_transfer=True, save_concurrent_bytes: 96000000000 (89.4 GiB), restore_concurrent_bytes: 96000000000 (89.4 GiB)
[2025-12-17 10:52:55,468][absl][INFO] - Deferred registration for item: "model". Adding handler `<orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler object at 0x14c870e2ced0>` for item "model" and save args `<class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardSaveArgs'>` and restore args `<class 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardRestoreArgs'>` to `_handler_registry`.
[2025-12-17 10:52:55,529][absl][INFO] - Scheduling D2H of 826 prioritized jax.Array.
[2025-12-17 10:52:55,530][absl][INFO] - Transferring arrays to host memory with options: use_replica_parallel=True, min_slice_bytes_for_replica_parallel=None, max_replicas_for_replica_parallel=None, enable_pinned_host_transfer=True
[2025-12-17 10:52:56,629][absl][INFO] - [process=0][thread=MainThread] Initiated "orbax.checkpoint._src.serialization.jax_array_handlers.ArrayHandler".serialize. Time taken: 1.100922s
[2025-12-17 10:52:56,640][absl][INFO] - [process=0] /jax/checkpoint/write/blocking_gbytes_per_sec: 2.124 GiB/s (total gbytes: 2.5 GiB) (time elapsed: a second) (per-host)
[2025-12-17 10:52:56,640][absl][INFO] - [process=0][thread=MainThread] Initiated Pytree async_save. Time taken: 1.165354s (batch_requests_ready=0.034730s, total_serialization_initiated=1.119642s, others=0.010983s)
[2025-12-17 10:52:56,640][absl][INFO] - [process=0][thread=MainThread] Initiated CompositeCheckpointHandler.async_save. Time taken: 1.177947s (all_items=0.000305s, per_item={'model': '0.00030518'}, temp_paths=1.177642)
[2025-12-17 10:52:56,678][absl][WARNING] - [process=0][thread=MainThread][operation_id=1] _SignalingThread.join() waiting for signals ([]) blocking the main thread will slow down blocking save times. This is likely due to main thread calling result() on a CommitFuture.
[2025-12-17 10:52:56,985][absl][INFO] - [process=0][thread=array_type_handler] Wrote 826 array_metadata.ArrayMetadata to /blue/weishao/chojnowski.h/JaxFM/new_model/0.orbax-checkpoint-tmp/model.orbax-checkpoint-tmp/array_metadatas/process_0
[2025-12-17 10:52:59,603][absl][INFO] - [process=0][thread=write_metadata_after_commits] Commit + Array metadata written. Time taken: 2.968966s (commit=2.939539s, array_metadata_write=0.029427s)
[2025-12-17 10:52:59,606][absl][INFO] - [process=0] /jax/checkpoint/write/gbytes_per_sec: 613.480 MiB/s (total gbytes: 2.5 GiB) (time elapsed: 4 seconds) (per-host)
[2025-12-17 10:52:59,612][absl][INFO] - Updated Metadata={'item_handlers': {'model': 'orbax.checkpoint._src.handlers.standard_checkpoint_handler.StandardCheckpointHandler'}, 'metrics': {}, 'performance_metrics': {}, 'init_timestamp_nsecs': 1765986775461170262, 'commit_timestamp_nsecs': None, 'custom_metadata': {}} to /blue/weishao/chojnowski.h/JaxFM/new_model/0.orbax-checkpoint-tmp/_CHECKPOINT_METADATA
[2025-12-17 10:52:59,618][absl][INFO] - [process=0][thread=MainThread] Skipped cross-host ArrayMetadata validation because only one process is found: process_index=0.
[2025-12-17 10:52:59,641][absl][INFO] - [process=0][thread=MainThread] Pytree save finalize (merge_ocdbt + ArrayMetadata validation) completed. Time taken: 0.028711s. use_zarr3=False, enable_post_merge_validation=True, directory=/blue/weishao/chojnowski.h/JaxFM/new_model/0.orbax-checkpoint-tmp/model.orbax-checkpoint-tmp
[2025-12-17 10:52:59,641][absl][INFO] - Renaming /blue/weishao/chojnowski.h/JaxFM/new_model/0.orbax-checkpoint-tmp/model.orbax-checkpoint-tmp to /blue/weishao/chojnowski.h/JaxFM/new_model/0.orbax-checkpoint-tmp/model
[2025-12-17 10:52:59,644][absl][INFO] - Renaming /blue/weishao/chojnowski.h/JaxFM/new_model/0.orbax-checkpoint-tmp to /blue/weishao/chojnowski.h/JaxFM/new_model/0
[2025-12-17 10:52:59,648][absl][INFO] - [process=0][thread=MainThread] Finished saving checkpoint (finalized tmp dir) to `/blue/weishao/chojnowski.h/JaxFM/new_model/0`.
[2025-12-17 10:52:59,648][absl][INFO] - Finished synchronous save in 4.20 seconds to /blue/weishao/chojnowski.h/JaxFM/new_model/0
[2025-12-17 10:52:59,649][absl][INFO] - [process=0][thread=MainThread][step=0] CheckpointManager Save Finalize is syncing with other hosts...
[2025-12-17 10:52:59,649][absl][INFO] - [process=0][thread=MainThread][step=0] CheckpointManager Save Finalize is done on all hosts.
[2025-12-17 10:52:59,649][absl][INFO] - [process=0][thread=MainThread][step=0] Finished synchronous save.
[2025-12-17 10:52:59,649][absl][INFO] - {'step': 0, 'event_type': 'save', 'directory': '/blue/weishao/chojnowski.h/JaxFM/new_model', 'reached_preemption': False, 'preemption_received_at': None, 'synchronous': True, 'wait_for_prev_start_time': 1765986775.4501922, 'wait_for_prev_duration_secs': 0.00018858909606933594, 'time_between_consecutive_saves_sec': None, 'checkpointer_blocking_start_time': 1765986775.4505007, 'checkpointer_blocking_duration_secs': 4.198304653167725, 'get_old_steps_start_time': 1765986779.6488266, 'get_old_steps_duration_secs': 9.918212890625e-05, 'checkpoint_manager_blocking_start_time': 1765986775.4501076, 'checkpoint_manager_blocking_duration_secs': 4.199041366577148}
[2025-12-17 10:52:59,649][absl][INFO] - [process=0][thread=MainThread][wait_until_finished] No Save Finalize thread to wait for. Returning.
